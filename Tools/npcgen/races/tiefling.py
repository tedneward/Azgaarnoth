"""
# Tiefling

* **Ability Score Increase**. Your Charisma score increases by 2. (This is true of all tieflings, regardless of bloodline.)

* **Age** Tieflings mature at the same rate as humans but live a few years longer.

* **Alignment** Tieflings might not have an innate tendency toward evil, but many of them end up there. Evil or not, an independent nature inclines many tieflings toward a chaotic alignment.

* **Size** Tieflings are about the same size and build as humans. Your size is Medium.

* **Speed** Your base walking speed is 30 feet.

* **Darkvision** Thanks to your infernal heritage, you have superior vision in dark and dim conditions. You can see in dim light within 60 feet of you as if it were bright light, and in darkness as if it were dim light. You can’t discern color in darkness, only shades of gray.

* **Hellish Resistance** You have resistance to fire damage.

* **Languages** You can speak, read, and write Common and Infernal.



## Tiefling Bloodlines

### Winged Bloodline
Rather than magic, certain tieflings inherit the leathery wings of their devilish ancestors.

* **Ability Score Increase** Your Intelligence score increases by 1.
* **Winged** You have bat-like wings sprouting from your shoulders. You have a flying speed of 30 feet while you aren’t wearing heavy armor.


### Bloodline of Asmodeus
The tieflings connected to Nessus command the power of fire and darkness, guided by a keener than normal intellect, as befits those linked to Asmodeus himself.

* **Ability Score Increase** Your Intelligence score increases by 1.

* **Infernal Legacy** You know the Thaumaturgy cantrip. Once you reach 3rd level, you can cast the Hellish Rebuke spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Darkness spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.


### Bloodline of Baalzebul
The crumbling realm of Maladomini is ruled by Baalzebul, who excels at corrupting those whose minor sins can be transformed into acts of damnation. Tieflings linked to this archdevil can corrupt others both physically and psychically.

* **Ability Score Increase** Your Intelligence score increases by 1.

* **Legacy of Maladomini** You know the [Thaumaturgy](https://www.dndbeyond.com/spells/thaumaturgy) cantrip. Once you reach 3rd level, you can cast the [Ray of Sickness](https://www.dndbeyond.com/spells/ray-of-sickness) spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the [Crown of Madness](https://www.dndbeyond.com/spells/crown-of-madness) spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.


### Devil's Tongue Bloodline
Aside from their raw physical and arcane power, many types of devils possess the means to warp and affect the attention of others. Tieflings may inherit some of these traits from a manipulative devilish ancestor.

* **Ability Score Increase** Your Intelligence score increases by 1.

* **Devil's Tongue**. You know the Vicious Mockery cantrip. Once you reach 3rd level, you can cast the Charm Person spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Enthrall spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.


## Bloodline of Dispater
The great city of Dis occupies most of Hell's second layer. It is a place where secrets are uncovered and shared with the highest bidder, making tieflings tied to Dispater excellent spies and infiltrators.

* **Ability Score Increase**. Your Dexterity score increases by 1.

* **Legacy of Dis**. You know the Thaumaturgy cantrip. Once you reach 3rd level, you can cast the Disguise Self spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Detect Thoughts spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.


## Bloodline of Fierna
A master manipulator, Fierna grants tieftings tied to her forceful personalities.

* **Ability Score Increase**. Your Wisdom score increases by 1.

* **Legacy of Phlegethos**. You know the [friends](https://www.dndbeyond.com/spells/friends)cantrip. Once you reach 3rd level, you can cast the Charm Person spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Suggestion spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.


## Bloodline of Glasya
Glasya, Hell's criminal mastermind, grants her tiefiings magic that is useful for committing heists.

* **Ability Score Increase**. Your Dexterity score increases by 1.

* **Legacy of Malbolge**. You know the Minor Illusion cantrip. Once you reach 3rd level, you can cast the Disguise Self spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Invisibility spell once as a 3rd-level spell. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.


## Bloodline of Levistus
Frozen Stygia is ruled by Levistus, an archdevil known for offering bargains to those who face an inescapable doom.

* **Ability Score Increase**. Your Constitution score increases by 1.

* **Legacy of Stygia**. You know the Ray of Frost cantrip. Once you reach 3rd level, you can cast the Armor of Agathys spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Darkness spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.


## Bloodline of Mammon
The great miser Mammon loves coins above all else. Tieflings tied to him excel at gathering and safeguarding wealth.

* **Ability Score Increase**. Your Intelligence score increases by 1.

* **Legacy of Minauros**. You know the [mage hand](https://www.dndbeyond.com/spells/mage-hand) cantrip. Once you reach 3rd level, you can cast the Tenser's Floating Disk spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the [arcane lock](https://www.dndbeyond.com/spells/arcane-lock) spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.


## Bloodline of Mephistopheles
In the frozen realm of Cania, Mephistopheles offers arcane power to those who entreat with him. Tieflings linked to him master some arcane magic.

* **Ability Score Increase**. Your Intelligence score increases by 1.

* **Legacy of Cania**. You know the [mage hand](https://www.dndbeyond.com/spells/mage-hand) cantrip. Once you reach 3rd level, you can cast the Burning Hands spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Flame Blade spell once as a 3rd-level spell. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.


## Bloodline of Zariel
Tieflings with a blood tie to Zariel are stronger than the typical tiefling and receive magical abilities that aid them in battle.

* **Ability Score Increase**. Your Strength score increases by 1.

* **Legacy of Avernus**. You know the Thaumaturgy cantrip. Once you reach 3rd level, you can cast the Searing Smite spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Branding Smite spell once as a 3rd-level spell. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.

*Source: [Unearthed Arcana: Fiendish Options](https://dnd.wizards.com/articles/unearthed-arcana/fiendish-options)*
"""
name = 'Tiefling'
def apply_race(npc):
    npc.size = 'Medium'
    npc.speed = '30 ft'

    npc.CHA += 2

    npc.features.append(commonfeatures['darkvision'])

    npc.resistances.append('fire')

    npc.languages.append('Common')
    npc.languages.append('Infernal')

# -------------
# Subraces
#

def winged(npc):
    """
### Winged Bloodline
Rather than magic, certain tieflings inherit the leathery wings of their devilish ancestors.

* **Ability Score Increase** Your Intelligence score increases by 1.
* **Winged** You have bat-like wings sprouting from your shoulders. You have a flying speed of 30 feet while you aren’t wearing heavy armor.
    """
    npc.description.append("**Winged Bloodline.** Rather than magic, certain tieflings inherit the leathery wings of their devilish ancestors.")

    npc.INT += 1
    npc.features.add("**Winged** You have a flying speed of 30 feet while you aren't wearing heavy armor.")
    npc.speed += '; flying 30ft'

def asmodeus(npc):
    """
### Bloodline of Asmodeus
The tieflings connected to Nessus command the power of fire and darkness, guided by a keener than normal intellect, as befits those linked to Asmodeus himself.

* **Ability Score Increase** Your Intelligence score increases by 1.

* **Infernal Legacy** You know the Thaumaturgy cantrip. Once you reach 3rd level, you can cast the Hellish Rebuke spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Darkness spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Bloodline of Asmodeus.** The tieflings connected to Nessus command the power of fire and darkness, guided by a keener than normal intellect, as befits those linked to Asmodeus himself.")

    npc.INT += 1
    npc.cantripsknown.append('thaumaturgy')

def baalzebul(npc):
    """
### Bloodline of Baalzebul
The crumbling realm of Maladomini is ruled by Baalzebul, who excels at corrupting those whose minor sins can be transformed into acts of damnation. Tieflings linked to this archdevil can corrupt others both physically and psychically.

* **Ability Score Increase** Your Intelligence score increases by 1.

* **Legacy of Maladomini** Once you reach 3rd level, you can cast the [Ray of Sickness](https://www.dndbeyond.com/spells/ray-of-sickness) spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the [Crown of Madness](https://www.dndbeyond.com/spells/crown-of-madness) spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Bloodline of Baalzebul.** The crumbling realm of Maladomini is ruled by Baalzebul, who excels at corrupting those whose minor sins can be transformed into acts of damnation. Tieflings linked to this archdevil can corrupt others both physically and psychically.")

    npc.INT += 1

    npc.cantripsknown.append("thaumaturgy")

def devilstongue(npc):
    """
### Devil's Tongue Bloodline
Aside from their raw physical and arcane power, many types of devils possess the means to warp and affect the attention of others. Tieflings may inherit some of these traits from a manipulative devilish ancestor.

* **Ability Score Increase** Your Intelligence score increases by 1.

* **Devil's Tongue**. You know the Vicious Mockery cantrip. Once you reach 3rd level, you can cast the Charm Person spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Enthrall spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Devil's Tongue Bloodline.** Aside from their raw physical and arcane power, many types of devils possess the means to warp and affect the attention of others. Tieflings may inherit some of these traits from a manipulative devilish ancestor.")

    npc.INT += 1

    npc.cantripsknown.append("vicious mockery")

def dispater(npc):
    """
## Bloodline of Dispater
The great city of Dis occupies most of Hell's second layer. It is a place where secrets are uncovered and shared with the highest bidder, making tieflings tied to Dispater excellent spies and infiltrators.

* **Ability Score Increase**. Your Dexterity score increases by 1.

* **Legacy of Dis**. You know the Thaumaturgy cantrip. Once you reach 3rd level, you can cast the Disguise Self spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Detect Thoughts spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Bloodline of Dispater.** The great city of Dis occupies most of Hell's second layer. It is a place where secrets are uncovered and shared with the highest bidder, making tieflings tied to Dispater excellent spies and infiltrators.")

    npc.DEX += 1

    npc.cantripsknown.append('thaumaturgy')

def fierna(npc):
    """
## Bloodline of Fierna
A master manipulator, Fierna grants tieftings tied to her forceful personalities.

* **Ability Score Increase**. Your Wisdom score increases by 1.

* **Legacy of Phlegethos**. You know the [friends](https://www.dndbeyond.com/spells/friends)cantrip. Once you reach 3rd level, you can cast the Charm Person spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Suggestion spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Bloodline of Fierna. A master manipulator, Fierna grants tieftings tied to her forceful personalities.")

    npc.WIS += 1

    npc.cantripsknown.append('friends')

def glasya(npc):
    """
## Bloodline of Glasya
Glasya, Hell's criminal mastermind, grants her tiefiings magic that is useful for committing heists.

* **Ability Score Increase**. Your Dexterity score increases by 1.

* **Legacy of Malbolge**. You know the Minor Illusion cantrip. Once you reach 3rd level, you can cast the Disguise Self spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Invisibility spell once as a 3rd-level spell. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Bloodline of Glasya.** Glasya, Hell's criminal mastermind, grants her tiefiings magic that is useful for committing heists.")

    npc.DEX += 1

    npc.cantripsknown.append('minor illusion')

def levistus(npc):
    """
## Bloodline of Levistus
Frozen Stygia is ruled by Levistus, an archdevil known for offering bargains to those who face an inescapable doom.

* **Ability Score Increase**. Your Constitution score increases by 1.

* **Legacy of Stygia**. You know the Ray of Frost cantrip. Once you reach 3rd level, you can cast the Armor of Agathys spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Darkness spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Bloodline of Levistus.** Frozen Stygia is ruled by Levistus, an archdevil known for offering bargains to those who face an inescapable doom.")

    npc.CON += 1

    npc.cantripsknown.append('ray of frost')

def mammon(npc):
    """
## Bloodline of Mammon
The great miser Mammon loves coins above all else. Tieflings tied to him excel at gathering and safeguarding wealth.

* **Ability Score Increase**. Your Intelligence score increases by 1.

* **Legacy of Minauros**. You know the [mage hand](https://www.dndbeyond.com/spells/mage-hand) cantrip. Once you reach 3rd level, you can cast the Tenser's Floating Disk spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the [arcane lock](https://www.dndbeyond.com/spells/arcane-lock) spell once. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Bloodline of Mammon.** The great miser Mammon loves coins above all else. Tieflings tied to him excel at gathering and safeguarding wealth.")

    npc.INT += 1

    npc.cantripsknown.append('mage hand')

def mephistopheles(npc):
    """
## Bloodline of Mephistopheles
In the frozen realm of Cania, Mephistopheles offers arcane power to those who entreat with him. Tieflings linked to him master some arcane magic.

* **Ability Score Increase**. Your Intelligence score increases by 1.

* **Legacy of Cania**. You know the [mage hand](https://www.dndbeyond.com/spells/mage-hand) cantrip. Once you reach 3rd level, you can cast the Burning Hands spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Flame Blade spell once as a 3rd-level spell. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Bloodline of Mephistopheles.** In the frozen realm of Cania, Mephistopheles offers arcane power to those who entreat with him. Tieflings linked to him master some arcane magic.")

    npc.INT += 1

    npc.cantripsknown.append('mage hand')

def zariel(npc):
    """
## Bloodline of Zariel
Tieflings with a blood tie to Zariel are stronger than the typical tiefling and receive magical abilities that aid them in battle.

* **Ability Score Increase**. Your Strength score increases by 1.

* **Legacy of Avernus**. You know the Thaumaturgy cantrip. Once you reach 3rd level, you can cast the Searing Smite spell once as a 2nd-level spell. Once you reach 5th level, you can also cast the Branding Smite spell once as a 3rd-level spell. You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells.
    """
    npc.description.append("**Bloodline of Zariel.** Tieflings with a blood tie to Zariel are stronger than the typical tiefling and receive magical abilities that aid them in battle.")

    npc.STR += 1

    npc.cantripsknown.append('thaumaturgy')

subracemap = {
    'Winged' : winged,
    'Asmodeus' : asmodeus,
    'Baalzebul' : baalzebul,
    'Devils Tongue': devilstongue,
    'Dispater' : dispater,
    'Fierna' : fierna,
    'Glasya' : glasya,
    'Levistus' : levistus,
    'Mammon' : mammon,
    'Mephistopheles' : mephistopheles,
    'Zariel' : zariel
}
subraces = list(subracemap.keys())
def apply_subrace(which, npc): subracemap[which](npc)

def level3(npc):
    pretext = "You can cast "
    posttext = " as a 2nd-level spell. You must finish a long rest to cast this spell again with this trait. (Save DC = 8 + proficiency bonus + CHA)"

    if npc.subrace == 'Asmodeus': 
        npc.actions.append("**Infernal Legacy.** " + pretext + spelllinkify('hellish rebuke') + posttext)

    elif npc.subrace == 'Baalzebul': 
        npc.actions.append("**Legacy of Maladomini.** " + pretext + spelllinkify('ray of sickness') + posttext)

    elif npc.subrace == 'Devils Tongue': 
        npc.actions.append("**Devil's Tongue.** " + pretext + spelllinkify('charm person') + posttext)

    elif npc.subrace == 'Dispater': 
        npc.actions.append("**Legacy of Dis.** " + pretext + spelllinkify('disguise self') + posttext)

    elif npc.subrace == 'Fierna': 
        npc.actions.append("**Legacy of Phlegethos.** " + pretext + spelllinkify('charm person') + posttext)

    elif npc.subrace == 'Glasya': 
        npc.actions.append("**Legacy of Malbolge.** " + pretext + spelllinkify('disguise self') + posttext)

    elif npc.subrace == 'Levistus': 
        npc.actions.append("**Legacy of Stygia.** " + pretext + spelllinkify('armor of agathys') + posttext)

    elif npc.subrace == 'Mammon': 
        npc.actions.append("**Legacy of Minauros.** " + pretext + spelllinkify('tensers floating disk') + posttext)

    elif npc.subrace == 'Mephistopheles': 
        npc.actions.append("**Legacy of Cania.** " + pretext + spelllinkify('burning hands') + posttext)

    elif npc.subrace == 'Zariel': 
        npc.actions.append("**Legacy of Avernus.** " + pretext + spelllinkify('searing smite') + posttext)

def level5(npc):
    pretext = "You can cast "
    midtext = " as a 2nd-level spell or "
    posttext = ". You must finish a long rest to cast these spells again with this trait. Charisma is your spellcasting ability for these spells."

    if npc.subrace == 'Asmodeus': 
        replace("**Infernal Legacy.**", npc.actions, "**Infernal Legacy.** " + pretext + spelllinkify('hellish rebuke') + midtext + spelllinkify('darkness') + posttext)

    elif npc.subrace == 'Baalzebul': 
        replace("**Legacy of Maladomini.**", npc.actions, "**Legacy of Maladomini.** " + pretext + spelllinkify('ray of sickness') + midtext + spelllinkify('crown of madness') + posttext)
    
    elif npc.subrace == 'Devils Tongue': 
        replace("**Devil's Tongue.**"), npc.actions, ("**Devil's Tongue.** " + pretext + spelllinkify('charm person') + midtext + spelllinkify('enthrall') + posttext)

    elif npc.subrace == 'Dispater': 
        replace("**Legacy of Dis.**"), npc.actions, ("**Legacy of Dis.** " + pretext + spelllinkify('disguise self') + midtext + spelllinkify('detect thoughts') + posttext)

    elif npc.subrace == 'Fierna': 
        replace("**Legacy of Phlegethos.**"), npc.actions, ("**Legacy of Phlegethos.** " + pretext + spelllinkify('charm person') + midtext + spelllinkify('suggestion') + posttext)

    elif npc.subrace == 'Glasya': 
        replace("**Legacy of Malbolge.**"), npc.actions, ("**Legacy of Malbolge.** " + pretext + spelllinkify('disguise self') + midtext + spelllinkify('invisibility') + " as a 3rd-level spell" + posttext)

    elif npc.subrace == 'Levistus': 
        replace("**Legacy of Stygia.**"), npc.actions, ("**Legacy of Stygia.** " + pretext + spelllinkify('armor of agathys') + midtext + spelllinkify('darkness') + posttext)

    elif npc.subrace == 'Mammon': 
        replace("**Legacy of Minauros.**"), npc.actions, ("**Legacy of Minauros.** " + pretext + spelllinkify('tensers floating disk') + midtext + spelllinkify('arcane lock') + posttext)

    elif npc.subrace == 'Mephistopheles': 
        replace("**Legacy of Cania.**"), npc.actions, ("**Legacy of Cania.** " + pretext + spelllinkify('burning hands') + midtext + spelllinkify('flame blade') + " as a 3rd-level spell" + posttext)

    elif npc.subrace == 'Zariel': 
        replace("**Legacy of Avernus.**"), npc.actions, ("**Legacy of Avernus.** " + pretext + spelllinkify('searing smite') + midtext + spelllinkify('branding smite') + " as a 3rd-level spell" + posttext)

